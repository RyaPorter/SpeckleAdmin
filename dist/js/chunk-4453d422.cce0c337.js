(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4453d422"],{"0a03":function(t,e,s){},"2f21":function(t,e,s){"use strict";var r=s("79e5");t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},"3c8d":function(t,e,s){"use strict";var r=s("defb"),a=s.n(r);a.a},4514:function(t,e,s){"use strict";var r=s("b26a"),a=s.n(r);a.a},"55dd":function(t,e,s){"use strict";var r=s("5ca1"),a=s("d8e8"),n=s("4bf8"),i=s("79e5"),c=[].sort,o=[1,2,3];r(r.P+r.F*(i(function(){o.sort(void 0)})||!i(function(){o.sort(null)})||!s("2f21")(c)),"Array",{sort:function(t){return void 0===t?c.call(n(this)):c.call(n(this),a(t))}})},6272:function(t,e,s){"use strict";var r=s("8aea"),a=s.n(r);a.a},"69e0":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("stream-detail-user-perms",{attrs:{stream:t.stream}})],1)},a=[],n=(s("7514"),s("cadf"),s("551c"),s("097d"),s("f7fe"),s("13bb"),s("fa20")),i={name:"StreamEditView",components:{StreamDetailUserPerms:n["a"]},computed:{stream:function(){var t=this;return this.$store.state.streams.find(function(e){return e.streamId===t.$route.params.streamId})},canEdit:function(){return!!this.isOwner||-1!==this.stream.canWrite.indexOf(this.$store.state.user._id)},isOwner:function(){return this.stream.owner===this.$store.state.user._id}},data:function(){return{}},methods:{}},c=i,o=(s("70ff"),s("2877")),d=Object(o["a"])(c,r,a,!1,null,"dbf16cc8",null);d.options.__file="StreamSharing.vue";e["default"]=d.exports},"6ec6":function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("md-card",{staticClass:"md-elevation-0 user-search",attrs:{"md-with-hover":""}},[s("md-card-content",[s("md-field",{attrs:{"md-clearable":""}},[s("md-icon",[t._v("search")]),s("label",[t._v("Search for a user to add")]),s("md-input",{on:{input:t.startSearchUsers},model:{value:t.userSearch,callback:function(e){t.userSearch=e},expression:"userSearch"}})],1),s("md-progress-bar",{directives:[{name:"show",rawName:"v-show",value:t.searchInProgress,expression:"searchInProgress"}],attrs:{"md-mode":"indeterminate","md-diameter":20,"md-stroke":2}}),s("div",{staticClass:"md-layout xxxsearch-results xxxmd-elevation-1"},[t._l(t.foundUsers,function(e){return null!==t.userSearch&&t.foundUsers.length>0?s("md-chip",{key:e._id,staticClass:"md-primary",staticStyle:{margin:"3px"},attrs:{"md-clickable":""},on:{click:function(s){t.selectUser(e._id)}}},[t._v("\n      "+t._s(e.name)+" "+t._s(e.surname)+" "),e.company?s("span",{staticClass:"md-caption"},[t._v("("+t._s(e.company)+")")]):t._e()]):t._e()}),0!==t.foundUsers.length||""===t.userSearch||t.searchInProgress?t._e():s("div",{staticClass:"md-caption"},[t._v("\n      No users found. Try a different search!\n    ")])],2)],1)],1)},a=[],n=(s("20d6"),s("f7fe")),i=s.n(n),c=s("bc3a"),o=s.n(c),d={name:"UserSearch",props:{msg:String},data:function(){return{userSearch:"",foundUsers:[],searchInProgress:!1}},watch:{userSearch:function(t,e){""===t&&(this.foundUsers=[],this.searchInProgress=!1)}},methods:{selectUser:function(t){this.$emit("selected-user",t);var e=this.foundUsers.findIndex(function(e){return e._id===t});this.foundUsers.splice(e,1)},startSearchUsers:function(){this.searchInProgress=!0,this.searchUsers(this.userSearch)},searchUsers:i()(function(t){var e=this;""===t&&(this.foundUsers=[],this.searchInProgress=!1),t.length<3||o.a.post("/accounts/search",{searchString:t}).then(function(t){console.log(t),e.foundUsers=t.data.resources,t.data.resources.length>0&&e.$store.commit("ADD_USERS",t.data.resources),e.searchInProgress=!1}).catch(function(t){e.foundUsers=[],e.searchInProgress=!1})},1500)}},u=d,m=(s("4514"),s("2877")),l=Object(m["a"])(u,r,a,!1,null,"5ba2af08",null);l.options.__file="UserSearch.vue";e["a"]=l.exports},"70ff":function(t,e,s){"use strict";var r=s("0a03"),a=s.n(r);a.a},"8aea":function(t,e,s){},b26a:function(t,e,s){},defb:function(t,e,s){},fa20:function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("md-card",{staticClass:"md-elevation-3"},[s("md-card-content",{staticClass:"bg-ghost-white"},[s("div",{staticClass:"md-layout md-alignment-center-center"},[s("div",{staticClass:"md-layout-item md-title md-size-70"},[t._v("Link Sharing")]),s("div",{staticClass:"md-layout-item md-title md-size-30 text-right"},[s("md-button",{class:{"md-raised":!0,"md-primary":!t.stream.private},attrs:{disabled:!t.canEdit},nativeOn:{click:function(e){return t.changeLinkSharing(e)}}},[t._v("\n          "+t._s(t.stream.private?"OFF":"ON")+"\n        ")])],1),s("div",{staticClass:"md-layout-item md-size-100 md-caption"},[t._v("\n        "+t._s(t.stream.private?"Private resource. Only people with read or write persmissions can access it.":"Public resource. Anyone with the id can access it.")+"\n        "),t.isOwner?s("span",{staticClass:"md-layout-item md-size-100 md-caption"},[t._v("\n        You are the "),s("strong",[t._v("owner")]),t._v(" of this stream.\n      ")]):s("span",{staticClass:"md-layout-item md-size-100 md-caption"},[t._v("\n        This stream was shared with you by "),s("strong",[t._v(t._s(t.streamOwner)+".")])])])])]),s("md-card-content",{staticClass:"bg-ghost-white"},[s("div",{staticClass:"md-layout"},[s("div",{staticClass:"md-layout-item md-size-100",staticStyle:{"margin-top":"20px"}},[s("div",{staticClass:"md-title"},[t._v("Permissions")]),t.canEdit?s("p",{staticClass:"md-caption"},[t.streamProjects.length>0?s("span",[t._v("Some users might be disabled as their permissions are set through the following projects: "),t._l(t.streamProjects,function(e,r){return s("router-link",{key:e._id,attrs:{to:"/projects/"+e._id}},[t._v(t._s(e.name)),r<t.streamProjects.length-1?s("span",[t._v(", ")]):t._e()])})],2):s("span",[t._v("Add or remove users below.")])]):s("p",{staticClass:"md-caption"},[t._v("You cannot edit the permissions of this stream.")])])])]),s("md-card-content",[s("div",{staticClass:"md-layout"},[s("div",{staticClass:"md-layout-item md-size-100",staticStyle:{"margin-top":"0px"}},[t.canEdit?s("user-search",{on:{"selected-user":t.addUserToWrite}}):t._e(),s("permission-table",{attrs:{resource:t.stream,"disabled-users":t.usersFromProjects,"global-disabled":!t.canEdit},on:{"update-table":t.updatePerms}})],1)])])],1)},a=[],n=(s("ac6a"),s("5df3"),s("4f7f"),s("2909")),i=(s("7514"),s("7f7f"),s("f7fe"),s("c36e")),c=s.n(i),o=(s("bc3a"),s("6ec6")),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{},[0===t.allUsersPop.length?s("div",[t._v("\n      No sharing buddies so far!\n    ")]):t._e(),t._l(t.allUsersPop,function(e){return e?s("div",{class:{"md-layout md-alignment-center-left user":!0,"bg-ghost-white":e.isOwner}},[s("div",{staticClass:"md-layout-item md-size-10 md-small-hide"},[s("md-avatar",{staticClass:"md-avatar-icon md-small",style:{background:t.getHexFromString(e.name)}},[t._v(t._s(e.name.substring(0,1).toUpperCase()))])],1),s("div",{staticClass:"md-layout-item md-size-40 md-xsmall-size-100"},[t._v("\n        "+t._s(e.name)+" "+t._s(e.surname)+" "),e.company?s("span",{staticClass:"md-caption"},[t._v("("+t._s(e.company)+")")]):t._e(),t._v(" "),e.isOwner?s("span",[s("strong",[t._v("owner")])]):t._e()]),s("div",{staticClass:"md-layout-item text-right text-center-small"},[s("md-button",{class:{"md-dense md-raised":!0,"md-primary":t.hasWritePermission(e._id)},attrs:{disabled:e.surname.includes("(that is you!)")||t.globalDisabled||t.isDisabled(e._id)},nativeOn:{click:function(s){t.changePermission(e._id)}}},[t._v(t._s(t.hasWritePermission(e._id)?"write":"read"))]),s("md-button",{staticClass:"md-dense-xxx md-icon-button md-accent",attrs:{disabled:e.surname.includes("(that is you!)")||t.globalDisabled||t.isDisabled(e._id)},nativeOn:{click:function(s){t.removeUser(e._id)}}},[s("md-icon",[t._v("delete")])],1)],1),s("div",{staticClass:"md-layout-item md-size-100"})]):t._e()})],2)])},u=[],m=(s("55dd"),s("13bb")),l=s.n(m),h={name:"PermissionTable",props:{resource:Object,globalDisabled:{type:Boolean,default:!1},disabledUsers:{type:Array,default:function(){return[]}}},computed:{canRead:function(){return Object(n["a"])(this.resource.canRead).concat([this.resource.owner])},canWrite:function(){return Object(n["a"])(this.resource.canWrite).concat([,this.resource.owner])},allUsers:function(){return l()(this.canRead,this.canWrite,[this.resource.owner])},allUsersPop:function(){var t=this;return 0===this.allUsers.length?[]:this.allUsers.map(function(e){var s=t.$store.state.users.find(function(t){return t._id===e});return s||t.$store.dispatch("getUser",{_id:e}),s&&(s.isOwner=s._id===t.resource.owner),s}).sort(function(t,e){return t.name>e.name?1:-1})}},data:function(){return{}},methods:{isDisabled:function(t){return this.disabledUsers.indexOf(t)>-1},hasWritePermission:function(t){return this.canWrite.indexOf(t)>-1},changePermission:function(t){var e=[],s=[],r=this.canWrite.indexOf(t);r>-1?(e=this.canWrite.filter(function(e){return e!==t}),s=c()(Object(n["a"])(this.canRead).concat([t]))):(s=this.canRead.filter(function(e){return e!==t}),e=c()(Object(n["a"])(this.canWrite).concat([t]))),this.$emit("update-table",{canRead:s,canWrite:e})},removeUser:function(t){var e=this.canWrite.filter(function(e){return e!==t}),s=this.canRead.filter(function(e){return e!==t});this.$emit("remove-user",{userId:t}),this.$emit("update-table",{canRead:s,canWrite:e})}},mounted:function(){}},f=h,p=(s("6272"),s("2877")),v=Object(p["a"])(f,d,u,!1,null,"d7fd35ae",null);v.options.__file="PermissionTable.vue";var _=v.exports,b={name:"StreamDetailUserPerms",components:{UserSearch:o["a"],PermissionTable:_},props:{stream:Object},computed:{streamOwner:function(){var t=this;if(this.isOwner)return"".concat(this.$store.state.user.name," ").concat(this.$store.state.user.surname);var e=this.$store.state.users.find(function(e){return e._id===t.stream.owner});return e?"".concat(e.name," ").concat(e.surname," ").concat(e.company?"("+e.company+")":""):"(loading)"},canEdit:function(){return!!this.isOwner||-1!==this.stream.canWrite.indexOf(this.$store.state.user._id)},isOwner:function(){return this.stream.owner===this.$store.state.user._id},usersFromProjects:function(){var t,e,s=this,r=this.$store.state.projects.filter(function(t){return-1!==t.streams.indexOf(s.stream.streamId)}),a=(t=Array.prototype).concat.apply(t,Object(n["a"])(r.map(function(t){return t.permissions.canRead}))),i=(e=Array.prototype).concat.apply(e,Object(n["a"])(r.map(function(t){return t.permissions.canWrite})));return Object(n["a"])(new Set(Object(n["a"])(i).concat(Object(n["a"])(a))))},streamProjects:function(){var t=this;return this.$store.state.projects.filter(function(e){return-1!==e.streams.indexOf(t.stream.streamId)})}},data:function(){return{userSearch:"",foundUsers:[],searchInProgress:!1}},methods:{changeLinkSharing:function(){this.$store.dispatch("updateStream",{streamId:this.stream.streamId,private:!this.stream.private})},addUserToWrite:function(t){var e=c()(Object(n["a"])(this.stream.canWrite).concat([t]));this.$store.dispatch("updateStream",{streamId:this.stream.streamId,canWrite:e})},updatePerms:function(t){var e=t.canRead,s=t.canWrite;this.$store.dispatch("updateStream",{streamId:this.stream.streamId,canRead:e,canWrite:s})}}},g=b,y=(s("3c8d"),Object(p["a"])(g,r,a,!1,null,"5e8786ac",null));y.options.__file="StreamDetailUserPerms.vue";e["a"]=y.exports}}]);
//# sourceMappingURL=chunk-4453d422.cce0c337.js.map